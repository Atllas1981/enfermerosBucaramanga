---
const testimonials = [
  {
    text: "Gracias a su enfermera, mi recuperación tras la lipo fue tranquila y sin complicaciones. ¡Totalmente recomendado!",
    name: "Ana M.",
    location: "Girón"
  },
  {
    text: "Como familiar de un adulto mayor, me da tranquilidad saber que está en manos profesionales y humanas.",
    name: "Carlos R.",
    location: "Floridablanca"
  },
  {
    text: "Excelente servicio y muy económico comparado con otras opciones. La enfermera fue muy atenta y profesional.",
    name: "María P.",
    location: "Bucaramanga"
  },
  {
    text: "Me ayudaron con las curaciones postquirúrgicas en casa, con mucha paciencia y respeto. El precio fue justo y el trato, impecable.",
    name: "Luis F.",
    location: "Piedecuesta"
  },
  {
    text: "Contraté el servicio de diálisis peritoneal y quedé impresionado por la puntualidad, la limpieza y la calidez humana.",
    name: "Elena G.",
    location: "Bucaramanga"
  },
  {
    text: "Encontré un servicio honesto, humano y profesional. Mi mamá recibió sus curaciones con tanto respeto que hasta sonreía.",
    name: "Jorge D.",
    location: "Lebrija"
  }
];
---

<section class="py-4 bg-white" aria-labelledby="testimonials-heading">
  <div class="container mx-auto px-4">

    <header class="text-center mb-12 animate-fade-in">
      <h2
        id="testimonials-heading"
        class="text-3xl md:text-4xl font-bold text-[hsl(210_20%_20%)] mb-4"
      >
        Lo Que Dicen Nuestros Pacientes
      </h2>
      <p class="text-xl text-[hsl(210_15%_45%)]">
        Experiencias reales de atención de enfermería a domicilio
      </p>
    </header>

    <!-- Carrusel móvil -->
    <div class="md:hidden px-2">
      <div
        id="testimonials-track"
        class="flex gap-6 pb-8 overflow-x-auto scrollbar-hide -mx-2 px-2 scroll-smooth"
      >
        {testimonials.map((t) => (
          <figure class="w-80 shrink-0 p-6 border border-[hsl(210_20%_90%)] rounded-xl bg-white shadow-sm relative">

            <span class="sr-only">
              Testimonio de paciente de enfermería domiciliaria en {t.location}
            </span>

            <blockquote class="relative z-10">
              <p class="text-[hsl(210_15%_45%)] italic mb-4">
                “{t.text}”
              </p>
            </blockquote>

            <figcaption class="border-t border-[hsl(210_20%_90%)] pt-4">
              <p class="font-semibold text-[hsl(210_20%_20%)]">{t.name}</p>
              <p class="text-sm text-[hsl(210_15%_45%)]">{t.location}</p>
            </figcaption>
          </figure>
        ))}
      </div>
    </div>

    <!-- Grid desktop -->
    <div class="hidden md:grid md:grid-cols-3 gap-8 max-w-6xl mx-auto">
      {testimonials.map((t, i) => (
        <figure
          class="p-6 border border-[hsl(210_20%_90%)] animate-slide-up"
          style={`animation-delay:${i * 100}ms`}
        >
          <span class="sr-only">
            Opinión de paciente sobre enfermería a domicilio en {t.location}
          </span>

          <blockquote>
            <p class="italic text-[hsl(210_15%_45%)] mb-4">
              “{t.text}”
            </p>
          </blockquote>

          <figcaption class="border-t pt-4">
            <p class="font-semibold">{t.name}</p>
            <p class="text-sm text-[hsl(210_15%_45%)]">{t.location}</p>
          </figcaption>
        </figure>
      ))}
    </div>

  </div>
</section>

<script is:client>
  function initTestimonialsAutoplay() {
    if (window.innerWidth >= 768) return;

    const track = document.getElementById('testimonials-track');
    if (!track) return;

    const cards = Array.from(track.children);
    if (!cards.length) return;

    let index = 0;

    setInterval(() => {
      index = (index + 1) % cards.length;
      track.scrollTo({
        left: cards[index].offsetLeft,
        behavior: 'smooth'
      });
    }, 4000);
  }

  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initTestimonialsAutoplay);
  } else {
    initTestimonialsAutoplay();
  }
</script>

<style>
.scrollbar-hide::-webkit-scrollbar { display: none; }
.scrollbar-hide { scrollbar-width: none; }
</style>
